<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WORKLY - Servicios Disponibles</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üöÄ</text></svg>">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #ffffff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .navbar-brand {
            font-weight: bold;
            font-size: 1.5rem;
            color: #2c3e50 !important;
        }
        .hero-section {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 2.5rem 0;
        }
        .category-card {
            border: 1px solid #e9ecef;
            border-radius: 8px;
            transition: all 0.3s ease;
            margin-bottom: 1rem;
            background: white;
        }
        .category-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .service-card {
            border: 1px solid #e9ecef;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            margin-bottom: 2rem;
            transition: all 0.3s ease;
            background: white;
        }
        .service-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .talent-card {
            border-left: 4px solid #3498db;
            background: #f8f9fa;
        }
        .btn-workly {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            border: none;
            color: white;
            font-weight: 500;
        }
        .btn-workly:hover {
            background: linear-gradient(135deg, #34495e 0%, #2980b9 100%);
            color: white;
        }
        .user-welcome {
            color: #2c3e50;
            font-weight: 500;
        }
        .card-header {
            background: white !important;
            border-bottom: 1px solid #e9ecef;
            color: #2c3e50;
        }
        .login-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #3498db;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        .more-categories {
            display: none;
        }
        .show-more-btn {
            background: none;
            border: none;
            color: #3498db;
            cursor: pointer;
            font-size: 0.9rem;
            padding: 5px 0;
        }
        .show-more-btn:hover {
            text-decoration: underline;
        }
        .text-truncate-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="text-center">
            <div class="spinner-border text-primary mb-3" role="status">
                <span class="visually-hidden">Cargando...</span>
            </div>
            <p>Verificando autenticaci√≥n...</p>
        </div>
    </div>

    <!-- Modal para requerir login -->
    <div class="modal fade" id="loginRequiredModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">üîê Inicio de Sesi√≥n Requerido</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Para acceder a esta funci√≥n necesitas iniciar sesi√≥n en tu cuenta.</p>
                    <div class="alert alert-info">
                        <small>¬øNo tienes cuenta? <a href="/register/" class="alert-link">Reg√≠strate gratis</a></small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <a href="/login/" class="btn btn-workly">Iniciar Sesi√≥n</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom">
        <div class="container">
            <a class="navbar-brand" href="/">üöÄ WORKLY</a>
            <div class="navbar-nav ms-auto">
                <span class="navbar-text me-3 user-welcome" id="userWelcome">
                    üëã Bienvenido a WORKLY
                </span>
                <div id="authButtons">
                    <a href="/login/" class="btn btn-workly btn-sm me-2">Iniciar Sesi√≥n</a>
                    <a href="/register/" class="btn btn-outline-dark btn-sm">Registrarse</a>
                </div>
                <div id="userMenu" style="display: none;">
                    <a href="/publicarme/" class="btn btn-workly btn-sm me-2">üìù Publicarme</a>
                    <a href="/profile/" class="btn btn-outline-primary btn-sm me-2">Mi Perfil</a>
                    <button class="btn btn-outline-dark btn-sm" onclick="logout()">Cerrar Sesi√≥n</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- P√°gina Principal -->
    <div id="mainPage" style="display: none;">
        <!-- Hero Section -->
        <section class="hero-section">
            <div class="container text-center">
                <h1 class="display-5 fw-bold">Servicios Disponibles</h1>
                <p class="lead">Encuentra los mejores profesionales y servicios en WORKLY</p>
            </div>
        </section>

        <!-- Main Content -->
        <div class="container my-5">
            <div class="row">
                <!-- Sidebar - Categor√≠as -->
                <div class="col-lg-3 mb-4">
                    <div class="card category-card">
                        <div class="card-header">
                            <h5 class="mb-0">üìã Categor√≠as</h5>
                        </div>
                        <div class="card-body">
                            <div class="list-group list-group-flush" id="categoriesList">
                                <div class="text-center">
                                    <div class="spinner-border spinner-border-sm" role="status">
                                        <span class="visually-hidden">Cargando categor√≠as...</span>
                                    </div>
                                    <small class="text-muted">Cargando categor√≠as...</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Main Content - Servicios -->
                <div class="col-lg-9">
                    <!-- Contenido P√∫blico (siempre visible) -->
                    <div class="row" id="publicContent">
                        <div class="col-12">
                            <div class="alert alert-info">
                                <strong>üí° Explora nuestros servicios:</strong> Puedes ver toda la informaci√≥n. <strong>Inicia sesi√≥n</strong> para ver m√°s detalles y categor√≠as espec√≠ficas.
                            </div>
                        </div>
                    </div>

                    <!-- Empresas/Servicios Destacados -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">üè¢ Servicios y Empresas Destacadas</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row" id="empresasContainer">
                                        <div class="col-12 text-center">
                                            <div class="spinner-border" role="status">
                                                <span class="visually-hidden">Cargando servicios...</span>
                                            </div>
                                            <p class="text-muted mt-2">Cargando servicios disponibles...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Talentos Humanos Disponibles -->
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">üë• Talentos Humanos Disponibles</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row" id="talentosContainer">
                                        <div class="col-12 text-center">
                                            <div class="spinner-border" role="status">
                                                <span class="visually-hidden">Cargando talentos...</span>
                                            </div>
                                            <p class="text-muted mt-2">Cargando talentos disponibles...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>üöÄ WORKLY</h5>
                    <p class="text-muted">Tu plataforma de confianza para servicios profesionales</p>
                </div>
                <div class="col-md-6 text-end">
                    <p class="text-muted">&copy; 2024 WORKLY. Todos los derechos reservados.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // URLs CONFIGURADAS
        const BACKEND_URL = 'http://127.0.0.1:8001';

        // Modal de Bootstrap
        const loginRequiredModal = new bootstrap.Modal(document.getElementById('loginRequiredModal'));

        // Variables globales
        let categoriasData = [];
        let publicidadesData = [];
        let usuariosData = {};

        // Verificar autenticaci√≥n ANTES de cargar la p√°gina
        document.addEventListener('DOMContentLoaded', async function() {
            await checkAuthentication();
            // Una vez verificada la autenticaci√≥n, mostrar la p√°gina y cargar datos
            document.getElementById('loadingOverlay').style.display = 'none';
            document.getElementById('mainPage').style.display = 'block';
            loadInitialData();
        });

        // Cargar datos iniciales
        async function loadInitialData() {
            try {
                await Promise.all([
                    loadCategorias(),
                    loadPublicidades(),
                    loadUsuarios()
                ]);
                renderHomeContent();
            } catch (error) {
                console.error('Error cargando datos iniciales:', error);
                showError('Error al cargar los datos');
            }
        }

        // Cargar categor√≠as desde la API
        async function loadCategorias() {
            try {
                const response = await fetch(`${BACKEND_URL}/api/categorias/`);
                if (!response.ok) throw new Error('Error al cargar categor√≠as');
                
                const data = await response.json();
                console.log('üìã Datos de categor√≠as recibidos:', data);
                
                // Manejar diferentes formatos de respuesta
                if (Array.isArray(data)) {
                    categoriasData = data;
                } else if (data.results && Array.isArray(data.results)) {
                    categoriasData = data.results;
                } else if (data.data && Array.isArray(data.data)) {
                    categoriasData = data.data;
                } else {
                    throw new Error('Formato de respuesta no reconocido');
                }
                
                console.log('üìã Categor√≠as procesadas:', categoriasData);
                renderCategorias();
            } catch (error) {
                console.error('Error cargando categor√≠as:', error);
                throw error;
            }
        }

        // Cargar publicidades desde la API
        async function loadPublicidades() {
            try {
                const response = await fetch(`${BACKEND_URL}/api/publicidades/`);
                if (!response.ok) throw new Error('Error al cargar publicidades');
                
                const data = await response.json();
                console.log('üì¢ Datos de publicidades recibidos:', data);
                
                // Manejar diferentes formatos de respuesta
                if (Array.isArray(data)) {
                    publicidadesData = data;
                } else if (data.results && Array.isArray(data.results)) {
                    publicidadesData = data.results;
                } else if (data.data && Array.isArray(data.data)) {
                    publicidadesData = data.data;
                } else {
                    throw new Error('Formato de respuesta no reconocido');
                }
                
                console.log('üì¢ Publicidades procesadas:', publicidadesData);
                
            } catch (error) {
                console.error('Error cargando publicidades:', error);
                throw error;
            }
        }

        // Cargar usuarios desde la API
        async function loadUsuarios() {
            try {
                const response = await fetch(`${BACKEND_URL}/api/usuarios/`);
                if (!response.ok) throw new Error('Error al cargar usuarios');
                
                const data = await response.json();
                console.log('üë• Datos de usuarios recibidos:', data);
                
                // Manejar diferentes formatos de respuesta
                let usuariosArray = [];
                if (Array.isArray(data)) {
                    usuariosArray = data;
                } else if (data.results && Array.isArray(data.results)) {
                    usuariosArray = data.results;
                } else if (data.data && Array.isArray(data.data)) {
                    usuariosArray = data.data;
                } else {
                    throw new Error('Formato de respuesta no reconocido');
                }
                
                // Crear un objeto para f√°cil acceso por ID
                usuariosData = {};
                usuariosArray.forEach(usuario => {
                    const usuarioId = usuario.id_usuario || usuario.id;
                    usuariosData[usuarioId] = usuario;
                });
                
                console.log('üë• Usuarios procesados:', usuariosData);
                
            } catch (error) {
                console.error('Error cargando usuarios:', error);
                // No lanzamos error para que la p√°gina funcione aunque falle la carga de usuarios
            }
        }

        // Funci√≥n para obtener nombre de categor√≠a por ID - VERSI√ìN CORREGIDA
        function getNombreCategoria(publicidad) {
            console.log('üîç Buscando categor√≠a para publicidad:', publicidad);
            
            // PRIMERO intentar con id_categoria (que viene del serializer)
            let categoriaId = publicidad.id_categoria;
            
            // Si no viene id_categoria, intentar con id_categoria_id
            if (!categoriaId && publicidad.id_categoria_id) {
                categoriaId = publicidad.id_categoria_id;
            }
            
            // Si a√∫n no hay categor√≠a, mostrar mensaje de debug
            if (!categoriaId) {
                console.log('‚ùå Publicidad sin ID de categor√≠a. Campos disponibles:', Object.keys(publicidad));
                return 'Categor√≠a no asignada';
            }
            
            console.log('üîç ID de categor√≠a encontrado:', categoriaId);
            
            // Buscar en las categor√≠as
            const categoria = categoriasData.find(cat => {
                const catId = cat.id_categoria || cat.id;
                return catId == categoriaId;
            });
            
            console.log('‚úÖ Categor√≠a encontrada:', categoria);
            
            return categoria ? categoria.nombre_categoria : 'Categor√≠a no encontrada';
        }

        // Funci√≥n para obtener nombre de usuario por ID
        function getNombreUsuario(publicidad) {
            // Usar id_usuario_id en lugar de id_usuario
            const usuarioId = publicidad.id_usuario_id;
            
            // Si tiene usuario_nombre, usarlo directamente
            if (publicidad.usuario_nombre) {
                return publicidad.usuario_nombre;
            }
            
            if (!usuarioId) {
                return 'Usuario desconocido';
            }
            
            const usuario = usuariosData[usuarioId];
            return usuario ? (usuario.nombre_completo || usuario.correo_electronico) : `Usuario ${usuarioId}`;
        }

        // Renderizar categor√≠as en el sidebar
        function renderCategorias() {
            const container = document.getElementById('categoriesList');
            
            if (!categoriasData || categoriasData.length === 0) {
                container.innerHTML = '<div class="text-muted">No hay categor√≠as disponibles</div>';
                return;
            }

            let categoriasHTML = '';
            const categoriasVisibles = categoriasData.slice(0, 5);
            const categoriasOcultas = categoriasData.slice(5);

            // Categor√≠as visibles
            categoriasVisibles.forEach(categoria => {
                categoriasHTML += `
                    <a href="#" class="list-group-item list-group-item-action border-0" 
                       onclick="showCategoryPage(${categoria.id_categoria || categoria.id})">
                        ${getCategoryIcon(categoria.nombre_categoria)} ${categoria.nombre_categoria}
                    </a>
                `;
            });

            // Categor√≠as ocultas
            if (categoriasOcultas.length > 0) {
                categoriasHTML += `
                    <div class="more-categories" id="moreCategories" style="display: none;">
                        ${categoriasOcultas.map(categoria => `
                            <a href="#" class="list-group-item list-group-item-action border-0" 
                               onclick="showCategoryPage(${categoria.id_categoria || categoria.id})">
                                ${getCategoryIcon(categoria.nombre_categoria)} ${categoria.nombre_categoria}
                            </a>
                        `).join('')}
                    </div>
                    <button class="show-more-btn mt-2" onclick="toggleMoreCategories()">
                        üìÇ Ver m√°s categor√≠as
                    </button>
                `;
            }

            container.innerHTML = categoriasHTML;
        }

        // Renderizar contenido del home
        function renderHomeContent() {
            renderEmpresas();
            renderTalentos();
        }

        // Renderizar empresas/servicios
        function renderEmpresas() {
            const container = document.getElementById('empresasContainer');
            
            // Mostrar la mitad de las publicidades como empresas (m√°ximo 2)
            const totalPublicidades = publicidadesData.length;
            const cantidadEmpresas = Math.min(2, Math.floor(totalPublicidades / 2));
            const empresas = publicidadesData.slice(0, cantidadEmpresas);

            if (empresas.length === 0) {
                container.innerHTML = `
                    <div class="col-12 text-center">
                        <p class="text-muted">No hay servicios disponibles en este momento.</p>
                    </div>
                `;
                return;
            }

            let empresasHTML = '';
            
            empresas.forEach(publicidad => {
                // CORREGIDO: Usar las funciones corregidas
                const categoriaNombre = getNombreCategoria(publicidad);
                const nombreUsuario = getNombreUsuario(publicidad);
                
                empresasHTML += `
                    <div class="col-md-6 mb-3">
                        <div class="card service-card h-100">
                            <div class="card-header">
                                <h6 class="card-title mb-0">${publicidad.titulo_publicidad}</h6>
                            </div>
                            <div class="card-body">
                                <p class="card-text text-muted text-truncate-3">
                                    ${publicidad.descripcion_detallada}
                                </p>
                                <div class="d-flex justify-content-between align-items-center mt-2">
                                    <span class="badge bg-primary">${categoriaNombre}</span>
                                    <small class="text-muted">Publicado por: ${nombreUsuario}</small>
                                </div>
                                <div class="d-flex justify-content-between align-items-center mt-2">
                                    <small class="text-muted">${formatDate(publicidad.fecha_publicacion)}</small>
                                </div>
                            </div>
                            <div class="card-footer bg-white border-0">
                                <button class="btn btn-outline-secondary btn-sm" onclick="showDetails(${publicidad.id_publicidad})">
                                    M√°s Informaci√≥n
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = empresasHTML;
        }

        // Renderizar talentos humanos
        function renderTalentos() {
            const container = document.getElementById('talentosContainer');
            
            // Mostrar el resto de las publicidades como talentos (m√≠nimo 1)
            const totalPublicidades = publicidadesData.length;
            const cantidadEmpresas = Math.min(2, Math.floor(totalPublicidades / 2));
            const talentos = publicidadesData.slice(cantidadEmpresas, totalPublicidades);

            if (talentos.length === 0) {
                container.innerHTML = `
                    <div class="col-12 text-center">
                        <p class="text-muted">No hay talentos disponibles en este momento.</p>
                    </div>
                `;
                return;
            }

            let talentosHTML = '';
            
            talentos.forEach(publicidad => {
                // CORREGIDO: Usar las funciones corregidas
                const categoriaNombre = getNombreCategoria(publicidad);
                const nombreUsuario = getNombreUsuario(publicidad);
                
                talentosHTML += `
                    <div class="col-md-4 mb-3">
                        <div class="card talent-card h-100">
                            <div class="card-body">
                                <h6 class="card-title">${publicidad.titulo_publicidad}</h6>
                                <p class="card-text small text-muted text-truncate-3">
                                    ${publicidad.descripcion_detallada}
                                </p>
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <span class="badge bg-info text-dark">${categoriaNombre}</span>
                                    <small class="text-muted">‚≠ê 4.5</small>
                                </div>
                                <div class="mb-2">
                                    <small class="text-muted"><strong>Publicado por:</strong> ${nombreUsuario}</small>
                                </div>
                                <button class="btn btn-outline-secondary btn-sm w-100" 
                                        onclick="showTalentDetails(${publicidad.id_publicidad})">
                                    M√°s Informaci√≥n
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = talentosHTML;
        }

        // Funci√≥n para obtener icono seg√∫n categor√≠a
        function getCategoryIcon(categoriaNombre) {
            const iconMap = {
                'electricidad': '‚ö°',
                'construcci√≥n': 'üß±',
                'plomer√≠a': 'üîß',
                'carpinter√≠a': 'üõ†Ô∏è',
                'refrigeraci√≥n': '‚ùÑÔ∏è',
                'mec√°nica': 'üöó',
                'turismo': 'üß≥',
                'limpieza': 'üè°',
                'reposter√≠a': 'üéÇ',
                'educaci√≥n': 'üéì',
                'cuidado': 'üë∂',
                'belleza': 'üíá'
            };

            for (const [key, icon] of Object.entries(iconMap)) {
                if (categoriaNombre.toLowerCase().includes(key)) {
                    return icon;
                }
            }
            return 'üîÆ';
        }

        // Funci√≥n para formatear fecha
        function formatDate(dateString) {
            try {
                const date = new Date(dateString);
                const options = { year: 'numeric', month: 'short', day: 'numeric' };
                return date.toLocaleDateString('es-ES', options);
            } catch (error) {
                return 'Fecha no disponible';
            }
        }

        // VERIFICACI√ìN DE AUTENTICACI√ìN MEJORADA
        async function checkAuthentication() {
            const token = localStorage.getItem('access_token');
            
            if (!token) {
                showPublicUI();
                return;
            }

            try {
                // Usamos Promise.race para agregar un timeout
                const response = await Promise.race([
                    fetch(`${BACKEND_URL}/auth/user-profile/`, {
                        method: 'GET',
                        headers: {
                            'Authorization': `Bearer ${token}`,
                            'Content-Type': 'application/json'
                        }
                    }),
                    new Promise((_, reject) => 
                        setTimeout(() => reject(new Error('Timeout')), 3000)
                    )
                ]);

                if (response.ok) {
                    showAuthenticatedUI();
                } else {
                    localStorage.removeItem('access_token');
                    localStorage.removeItem('refresh_token');
                    localStorage.removeItem('user_data');
                    showPublicUI();
                }
                
            } catch (error) {
                console.error('Error verificando autenticaci√≥n:', error);
                // En caso de error, mostramos la UI p√∫blica
                showPublicUI();
            }
        }

        function showAuthenticatedUI() {
            const userData = localStorage.getItem('user_data');
            let userName = 'Usuario';
            
            if (userData) {
                try {
                    const user = JSON.parse(userData);
                    userName = user.nombre_completo || user.correo_electronico || 'Usuario';
                } catch (e) {
                    console.error('Error parsing user data:', e);
                }
            }
            
            document.getElementById('userWelcome').textContent = `üëã Bienvenido, ${userName}`;
            document.getElementById('authButtons').style.display = 'none';
            document.getElementById('userMenu').style.display = 'flex';
            document.querySelectorAll('.login-badge').forEach(badge => {
                badge.style.display = 'none';
            });
            document.getElementById('publicContent').style.display = 'none';
        }

        function showPublicUI() {
            document.getElementById('userWelcome').textContent = 'üëã Bienvenido a WORKLY';
            document.getElementById('authButtons').style.display = 'block';
            document.getElementById('userMenu').style.display = 'none';
            document.querySelectorAll('.login-badge').forEach(badge => {
                badge.style.display = 'block';
            });
            document.getElementById('publicContent').style.display = 'flex';
        }

        function toggleMoreCategories() {
            const moreCategories = document.getElementById('moreCategories');
            const button = document.querySelector('.show-more-btn');
            
            if (moreCategories.style.display === 'none' || moreCategories.style.display === '') {
                moreCategories.style.display = 'block';
                button.textContent = 'üìÇ Ver menos categor√≠as';
            } else {
                moreCategories.style.display = 'none';
                button.textContent = 'üìÇ Ver m√°s categor√≠as';
            }
        }

        function requireLogin() {
            const token = localStorage.getItem('access_token');
            if (!token) {
                loginRequiredModal.show();
                return false;
            }
            return true;
        }

        function showDetails(publicidadId) {
            if (requireLogin()) {
                alert(`üîß Ver detalles de publicidad ID: ${publicidadId}`);
            }
        }

        function showTalentDetails(publicidadId) {
            if (requireLogin()) {
                alert(`üîß Ver detalles de talento ID: ${publicidadId}`);
            }
        }

        function showCategoryPage(categoriaId) {
            if (requireLogin()) {
                alert(`üîß Navegar a categor√≠a ID: ${categoriaId}`);
            }
        }

        function showMainPage() {
            document.getElementById('mainPage').style.display = 'block';
        }

        function logout() {
            localStorage.removeItem('access_token');
            localStorage.removeItem('refresh_token');
            localStorage.removeItem('user_data');
            window.location.href = "/logout/";
        }

        function showError(message) {
            alert(`‚ùå Error: ${message}`);
        }
    </script>
</body>
</html>